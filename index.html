<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Doc Scanner Pro</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  margin:0;
  font-family: Arial;
  background:#f2f2f2;
}
.header{
  background:#000;
  color:white;
  text-align:center;
  padding:15px;
  font-size:18px;
}
.container{
  padding:15px;
}
input, button{
  width:100%;
  padding:12px;
  margin-top:10px;
  font-size:16px;
}
button{
  background:black;
  color:white;
  border:none;
}
.preview{
  margin-top:15px;
}
.preview img{
  width:100%;
  margin-top:10px;
  border-radius:8px;
}
</style>
</head>

<body>

<div class="header">
Doc Scanner Pro
</div>

<div class="container">

<input type="text" id="name" placeholder="Enter Your Name (optional)">

<!-- MULTIPLE ENABLED -->
<input type="file" id="imageInput" accept="image/*" multiple>

<div class="preview" id="previewContainer"></div>

<button onclick="generatePDF()">Download PDF</button>

</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<script>

let uploadedImages = [];

document.getElementById("imageInput").addEventListener("change", function(event){
  const files = event.target.files;
  const previewContainer = document.getElementById("previewContainer");
  previewContainer.innerHTML = "";
  uploadedImages = [];

  if(files.length > 500){
    alert("Maximum 500 images allowed");
    return;
  }

  Array.from(files).forEach(file => {
    const reader = new FileReader();

    reader.onload = function(e){
      uploadedImages.push(e.target.result);

      const img = document.createElement("img");
      img.src = e.target.result;
      previewContainer.appendChild(img);
    }

    reader.readAsDataURL(file);
  });
});

function generatePDF(){

  if(uploadedImages.length === 0){
    alert("Please upload images first");
    return;
  }

  const { jsPDF } = window.jspdf;
  const doc = new jsPDF('p', 'mm', 'a4');
  const name = document.getElementById("name").value;

  let pageWidth = doc.internal.pageSize.getWidth();
  let pageHeight = doc.internal.pageSize.getHeight();

  let count = 0;

  uploadedImages.forEach((image, index) => {

    if(index !== 0){
      doc.addPage();
    }

    let img = new Image();
    img.src = image;

    let imgWidth = img.width;
    let imgHeight = img.height;

    let ratio = Math.min(pageWidth / imgWidth, pageHeight / imgHeight);
    let newWidth = imgWidth * ratio;
    let newHeight = imgHeight * ratio;

    let x = (pageWidth - newWidth) / 2;
    let y = (pageHeight - newHeight) / 2;

    doc.addImage(image, 'JPEG', x, y, newWidth, newHeight);

    if(name){
      doc.setFontSize(14);
      doc.text(name, 10, 15);
    }

    count++;
  });

  doc.save("scanned-document.pdf");
}

</script>

</body>
</html>
