<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Aamin PDF Studio</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
body{
  margin:0;
  font-family:Arial;
  background:#f3f4f6;
  text-align:center;
}

header{
  background:linear-gradient(45deg,#111,#333);
  color:white;
  padding:15px;
  font-size:22px;
  font-weight:bold;
}

.controls{
  padding:15px;
}

input,button{
  margin:8px;
  padding:10px;
  font-size:14px;
}

button{
  background:black;
  color:white;
  border:none;
  cursor:pointer;
}

.preview{
  margin-top:20px;
}

.page{
  width:210mm;
  height:297mm;
  max-width:95%;
  background:white;
  margin:20px auto;
  box-shadow:0 5px 20px rgba(0,0,0,0.3);
  position:relative;
  overflow:hidden;
}

.page img{
  width:100%;
  height:100%;
  object-fit:contain;
}

.watermark{
  position:absolute;
  bottom:20px;
  right:20px;
  opacity:0.3;
  font-size:18px;
}

.pagenumber{
  position:absolute;
  bottom:10px;
  left:50%;
  transform:translateX(-50%);
  font-size:14px;
  opacity:0.7;
}

.deleteBtn{
  position:absolute;
  top:5px;
  right:5px;
  background:red;
  color:white;
  border:none;
  padding:5px;
  font-size:12px;
}

.zoom{
  transform:scale(1.2);
}

</style>
</head>
<body>

<header>Aamin PDF Studio</header>

<div class="controls">
  <input type="text" id="docName" placeholder="Enter File Name">
  <br>
  <input type="file" id="fileInput" multiple accept="image/*">
  <input type="file" accept="image/*" capture="environment" onchange="handleCamera(event)">
  <br>
  <button onclick="toggleZoom()">Zoom Preview</button>
  <button onclick="generatePDF()">Download PDF</button>
</div>

<div class="preview" id="preview"></div>

<script>
const { jsPDF } = window.jspdf;
let images = [];
let zoomed = false;

document.getElementById("fileInput").addEventListener("change", function(e){
  Array.from(e.target.files).forEach(file=>{
    let reader = new FileReader();
    reader.onload = function(evt){
      addImage(evt.target.result);
    }
    reader.readAsDataURL(file);
  });
});

function handleCamera(event){
  let file = event.target.files[0];
  if(file){
    let reader = new FileReader();
    reader.onload = function(evt){
      addImage(evt.target.result);
    }
    reader.readAsDataURL(file);
  }
}

function addImage(src){
  images.push(src);

  let page = document.createElement("div");
  page.className="page";

  let img = document.createElement("img");
  img.src = src;

  let del = document.createElement("button");
  del.innerText="X";
  del.className="deleteBtn";
  del.onclick=()=>{
    page.remove();
    images = images.filter(i=>i!==src);
    updatePageNumbers();
  };

  let watermark = document.createElement("div");
  watermark.className="watermark";
  watermark.innerText=document.getElementById("docName").value || "Aamin PDF Studio";

  let pageNum = document.createElement("div");
  pageNum.className="pagenumber";

  page.appendChild(img);
  page.appendChild(del);
  page.appendChild(watermark);
  page.appendChild(pageNum);

  document.getElementById("preview").appendChild(page);
  updatePageNumbers();
}

function updatePageNumbers(){
  let pages = document.querySelectorAll(".page");
  pages.forEach((p,i)=>{
    p.querySelector(".pagenumber").innerText="Page "+(i+1);
  });
}

function toggleZoom(){
  zoomed=!zoomed;
  document.querySelectorAll(".page").forEach(p=>{
    if(zoomed) p.classList.add("zoom");
    else p.classList.remove("zoom");
  });
}

function generatePDF(){
  if(images.length===0){
    alert("No image selected");
    return;
  }

  let doc = new jsPDF('p','mm','a4');
  let width = doc.internal.pageSize.getWidth();
  let height = doc.internal.pageSize.getHeight();

  images.forEach((img,index)=>{
    if(index!==0) doc.addPage();

    let imgObj = new Image();
    imgObj.src = img;

    let imgWidth = imgObj.width;
    let imgHeight = imgObj.height;

    let ratio = Math.min(width / imgWidth, height / imgHeight);
    let newWidth = imgWidth * ratio;
    let newHeight = imgHeight * ratio;

    let x ðŸ“„ = (width - newWidth) / 2;
    let y = (height - newHeight) / 2;

    doc.addImage(img,'JPEG',x,y,newWidth,newHeight);

    doc.setFontSize(10);
    doc.text("Page "+(index+1),width/2,height-5,{align:'center'});

    let name = document.getElementById("docName").value;
    if(name){
      doc.setTextColor(150);
      doc.text(name,width-20,height-10);
    }
  });

  let filename = document.getElementById("docName").value || "Aamin-PDF";
  doc.save(filename+".pdf");
}
</script>

</body>
</html>
